## Which NYC schools have the best math results?

The best math results are at least 80% of the *maximum possible score of 800* for math.
Save your results in a pandas DataFrame called best_math_schools, including "school_name" and "average_math" columns, sorted by "average_math" in descending order.


## What are the top 10 performing schools based on the combined SAT scores?

Save your results as a pandas DataFrame called top_10_schools containing the "school_name" and a new column named "total_SAT", with results ordered by "total_SAT" in descending order ("total_SAT" being the sum of math, reading, and writing scores).


## Which single borough has the largest standard deviation in the combined SAT score?

Save your results as a pandas DataFrame called largest_std_dev.
The DataFrame should contain one row, with:
"borough" - the name of the NYC borough with the largest standard deviation of "total_SAT".
"num_schools" - the number of schools in the borough.
"average_SAT" - the mean of "total_SAT".
"std_SAT" - the standard deviation of "total_SAT".
Round all numeric values to two decimal places.

# import pandas
import pandas as pd

# Read in the data
schools = pd.read_csv("schools.csv")

# Preview the data
schools.head()

# 1) Find schools with the best math results (≥ 80% of 800 → ≥ 640)
threshold = 800 * 0.8
best_math_schools = (schools[schools["average_math"] >= threshold][["school_name", "average_math"]]
    .sort_values("average_math", ascending=False))


# 2) Compute total SAT and get top 10 schools
schools["total_SAT"] = (schools["average_math"] + schools["average_reading"] + schools["average_writing"])

top_10_schools = (schools[["school_name", "total_SAT"]].sort_values("total_SAT", ascending=False).head(10))


# 3) Which borough has the largest standard deviation in total SAT
borough_stats = (schools.groupby("borough")["total_SAT"].agg(["count", "mean", "std"]).round(2))

# find the borough with the max std dev
max_std = borough_stats["std"].max()
largest_std_dev = borough_stats[borough_stats["std"] == max_std]

# rename columns
largest_std_dev = largest_std_dev.rename(columns = {"count": "num_schools", "mean": "average_SAT", "std": "std_SAT"}).reset_index()

# Display results
print("Best math schools:\n", best_math_schools)
print("\nTop 10 schools by total SAT:\n", top_10_schools)
print("\nBorough with largest SAT score std dev:\n", largest_std_dev)
